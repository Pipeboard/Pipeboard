version: 2.1
jobs:
  run-test:
    docker:
      - image: ubuntu
    steps:
      - prep-test
      - execute-test
commands:
  prep-test:
    steps:
      - run: apt-get update
      - run: curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
      - run: yarn update | yarn install npm && npm install
  execute-test:
    steps:
      - run: npm run circleci_test
workflows:
   version: 2
   test:
     jobs:
       - run-test
